knitr::opts_chunk$set(echo = TRUE)
if (!requireNamespace("rmarkdown", quietly = TRUE))
+     install.packages("rmarkdown")
if (!requireNamespace("knitr", quietly = TRUE))
+     install.packages("knitr")
if (!requireNamespace("pandoc", quietly = TRUE))
+     install.packages("pandoc")
if (!requireNamespace("devtools", quietly = TRUE))
+     install.packages("devtools")
if (!requireNamespace("BiocManager", quietly = TRUE))
+     install.packages("BiocManager")
if (!requireNamespace("edgeR", quietly = TRUE))
BiocManager::install("edgeR")
if (!requireNamespace("biomaRt", quietly = TRUE))
BiocManager::install("biomaRt")
if (!requireNamespace("GEOmetadb", quietly = TRUE))
BiocManager::install("GEOmetadb")
if (!requireNamespace("GEOquery", quietly = TRUE))
+     install.packages("GEOquery")
if (!requireNamespace("DBI", quietly = TRUE))
+     install.packages("DBI")
if (!requireNamespace("RSQLite", quietly = TRUE))
+     install.packages("RSQLite")
if(!requireNamespace("kableExtra", quietly=TRUE))
install.packages("kableExtra")
library(devtools)
library(rmarkdown)
library(knitr)
library(pandoc)
library(BiocManager)
library(GEOmetadb)
library(GEOquery)
library(DBI)
library(RSQLite)
library(edgeR)
library(biomaRt)
library(kableExtra)
sql <- paste("SELECT DISTINCT gse.title,gse.gse, gpl.title,",
" gse.submission_date,",
" gse.supplementary_file",
"FROM",
"  gse JOIN gse_gpl ON gse_gpl.gse=gse.gse",
"  JOIN gpl ON gse_gpl.gpl=gpl.gpl",
"WHERE",
"  gse.submission_date > '2013-01-01' AND",
"  gse.title LIKE '%Metabolic Syndrome%' AND",
"  gpl.organism LIKE '%Homo sapiens%' AND",
"  gpl.technology LIKE '%high-throughput sequencing%' ",
"  ORDER BY gse.submission_date DESC",sep=" ")
con <- dbConnect(SQLite(),'GEOmetadb.sqlite')
rs <- dbGetQuery(con,sql)
num_series <- dbGetQuery(con,
paste("select * from gsm where series_id in ('",
paste(series_of_interest,collapse="','"),
"')", collapse = ""))
gse <- getGEO("GSE166474",GSEMatrix=FALSE)
kable(data.frame(head(Meta(gse))), format = "pipe")
names(GSMList(gse))
show(getGEO("GSE166474",GSEMatrix=TRUE))
show(pData(phenoData((getGEO("GSE166474",GSEMatrix=TRUE)[[1]]))[,c(1,6,8)]))
current_gpl <- names(GPLList(gse))[1]
current_gpl_info <- Meta(getGEO(current_gpl))
current_gpl_info$title
current_gpl_info$last_update_date
current_gpl_info$organism
length(current_gpl_info$series_id)
length(current_gpl_info$sample_id)
sfiles = getGEOSuppFiles('GSE166474')
fnames = rownames(sfiles)
data_table = read.delim(fnames[1],header=TRUE,
check.names = FALSE)
##data_table2 = read.table(fnames[1],header=TRUE,
##           check.names=FALSE)
##data_table3 = read.table(fnames[1],header=TRUE,
##           check.names=TRUE,nrows = 1)[1,]
#kable(data_table[1:15,], format = "pipe")
data_table[1:15, 1:4] %>%
kableExtra::kbl(caption = "Expressed lncRNA") %>%
kableExtra::kable_classic(full_width = F, html_font = "Cambria")
dim(data_table)
colnames(data_table)[1] <- "ensembl_id"
colnames(data_table)
samples <- data.frame(lapply(colnames(data_table)[2:11],
FUN=function(x){unlist(strsplit(x,
split = "\\_"))[c(1,2)]}))
colnames(samples) <- colnames(data_table)[2:11]
rownames(samples) <- c("Case", "Seq")
samples <- data.frame(t(samples))
citation("GEOmetadb")
citation("BiocManager")
citation("edgeR")
citation("GEOquery")
citation("DBI")
citation("RSQLite")
citation("kableExtra")
